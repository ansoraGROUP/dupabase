services:
  dupabase:
    image: ghcr.io/ansoragroup/dupabase:prod-latest
    container_name: dupabase
    ports:
      - "${DUPABASE_PORT:-3333}:3333"
    env_file:
      - .env
    environment:
      PORT: "3333"
      HOST: "0.0.0.0"
      SITE_URL: "${SITE_URL}"
      DATABASE_URL: "${DATABASE_URL}"
      PLATFORM_JWT_SECRET: "${PLATFORM_JWT_SECRET}"
      MAX_CONNECTIONS_PER_DB: "${MAX_CONNECTIONS_PER_DB:-10}"
      GLOBAL_MAX_CONNECTIONS: "${GLOBAL_MAX_CONNECTIONS:-200}"
      POOL_IDLE_TIMEOUT_SECONDS: "${POOL_IDLE_TIMEOUT_SECONDS:-300}"
      DEFAULT_ENABLE_SIGNUP: "${DEFAULT_ENABLE_SIGNUP:-true}"
      DEFAULT_AUTOCONFIRM: "${DEFAULT_AUTOCONFIRM:-false}"
      DEFAULT_PASSWORD_MIN_LENGTH: "${DEFAULT_PASSWORD_MIN_LENGTH:-8}"
      ADMIN_EMAIL: "${ADMIN_EMAIL}"
      ADMIN_PASSWORD: "${ADMIN_PASSWORD}"
      ALLOWED_ORIGINS: "${ALLOWED_ORIGINS}"
      BACKUP_ENCRYPTION_KEY: "${BACKUP_ENCRYPTION_KEY:-}"
    labels:
      - "com.centurylinklabs.watchtower.enable=true"
    networks:
      - ansora_network
    restart: unless-stopped

networks:
  ansora_network:
    external: true
